---
title: SQL Notes
date: 2019-01-25 14:50:14
tags:
- SQL
- Database
categories: Notes
---

## Database Management Systems (DBMS)
- oracle
- sql server
- DB2
- Mysql
- PostgreSQL
- SQLite
- MS Access
- MongoDB
(express verison is free)

![](https://i.imgur.com/YMD1YN4.jpg)

- Database -> table -> data
- Build table by col, unique col and non unique col
- Read table by row -> use key

![](https://i.imgur.com/n7u8LHd.jpg)

**Primary Key** is generated by table, the unique key

![](https://i.imgur.com/bO9OspY.jpg)

![](https://i.imgur.com/hIZzYHA.jpg)


## One to many
![](https://i.imgur.com/E8eBZkP.jpg)

## Many to many 
Using junction or linking table, Composite Key

![](https://i.imgur.com/Da4GjzR.jpg)

![](https://i.imgur.com/Z5UpyqZ.jpg)

## One to one
No common use
![](https://i.imgur.com/xAA0vT0.jpg)

## Transaction - ACID Test
- Atomic
- Consistent
- Isolated
- Durable

## SQL
![](https://i.imgur.com/hHpWxG0.jpg)

## Deleting
### Cascading Delete
![](https://i.imgur.com/XRrhwcw.jpg)

### Cascading Nullify
![](https://i.imgur.com/WH69g4p.jpg)

### No Action
Will not allow to delete until delete all orders or replace a new customer.
![](https://i.imgur.com/erQq2od.jpg)

## Normalization
Fix redundancy, not performance

### Apply FIrst Nirmal Form (1NF):
Each col in each table contains one value, no repeating groups

![](https://i.imgur.com/U4D0OZi.jpg)

### Apply Second Normal Form (2NF)
Any non-key field should be dependent on the entire primary keys. (only happened when with composite keys)

![](https://i.imgur.com/mlyZIxX.jpg)
_Break the 2NF_

![](https://i.imgur.com/vi4PcXv.jpg)
_Fixed with 2NF, break 3NF_

### Apply Third Normal Form (3NF)
No non-key field is dependent on any other non-key field.

![](https://i.imgur.com/3eqTBKW.jpg)
_Break 3NF_

![](https://i.imgur.com/g4ObTea.jpg)
_Fixed with 3NF_

![](https://i.imgur.com/fjQhiVu.jpg)
_Break 3NF_

![](https://i.imgur.com/Z0eU02v.jpg)
_Fixed with 3NF by deleting calculate_

## Denomalizated
For performance (zipcode, multi-emails...)

## SQL Language
#### Select
`SELECT <col_name>, <col2_name> / * / SELECT COUNT(*) / SELECT MAX(<col_name>), MIN(), AVG(), SUM()`
#### From 
`FROM <table_name>`
#### Where 
Condition: 
`WHERE <col_name> = ... AND .... OR .... IN ('A', 'B') ... LIKE 'Green%' / LIKE 'Sm_th' ... IS NULL ... IS NOT NULL...`
#### Order by
`ORDER BY <col_name> DESC, ORDER BY <col_a>, <col_b>`
#### Group by 
Use with select count: 
`SELECT COUNT(*), Color FROM <Product> GROUP BY <Color>`
#### (inner) Join
`join two table, one to many,  SELECT table1.xxxx, table2.xxxx ... FROM table1 JOIN table2 On table1.id = table2.id`
- Only join if is in another table with **inner join**. 
- LEFT OUTER JOIN / RIGHT OUTER JOIN / FULL OUTER JOIN for **outer join**
#### Insert into 
`INSERT INTO <table_name> (<col_name1>, <col_name2>, <col_name3>) VALUES (a, b, c)`
#### Update 
For one row strictly:
`UPDATE <table_name> SET <col_name = ''> WHERE <col = xxxx>`
#### Delete
`DELETE FROM <table_name> WHERE <col=xxxx>`
#### Having
#### In

### End
With `;`

### String in SQL
With single quote `\``

### equal in SQL
With single `=`

### Cross Database Example
`SELECT <col_name> FROM <HumanResources.Emplyee> WHERE <col = xxx>;`

### Good Habit for delete
``` sql
SELECT * FROM Employee WHERE EmployeeID = 734;
DELETE FROM Employee WHERE EmployeeID = 734;
```

## SQL Statement Types
- Data Manipulation
    - SELECT
    - INSERT
    - UPDATE
    - DELETE
- Data Definition
    - CREATE
    - ALTER
    - DROP
- DATA CONTROL
    - GRANT
    - REVOKE

### CREATE
``` sql
Create table_name
(<col_name> INTEGER PrimaryKey,
<FirstName> VARCHAR(35) NOT NULL,
...
)
```

### ALRER
``` sql
ALTER TABLE <table_name>
ADD col_name VARCHAR(100)
```

### DROP
`DROP TABLE <table_name>`

## Clustered INDEX
- Default is PK
- Each table can only have one clusterd index, but can have many non-clustered(secondary) index.
- Faster reads and slower wirtes

## Transaction to atonic
Pessimistic Locking / optimisitc Locking

## Stored Procedures
Aviod SQL injection
``` sql
CREATE PROCEDURES procedures(IN dept VARCH(50))
     ...
     ...
     ...
END;
CALL procedures('Accounting');
```
## Other Database Systems
### XML Database Systems (XQuery)
- BaseX
- Sedna
- eXist

### Object-Oriented Database Systems
- Objectivity/DB
- VelocityDB
- Versant

### Object-Relational Mapping (ORM)
- Hibernate / java
- Core Data / Objective-c
- ActiveRecord / Ruby
- NHibernate / C#/ VB.NET

### NoSQL Categroy, aren't relatioanl database
- CouchDB
- MongoDB
- Apache Cassandra
- Hypertable
- HBase
- Neo4k
- BigTable
- Riak
- Prokecy Voldemort
- Redis

#### features including
- No SQL / No table / No relationships oriented/ No ACID/ No formal, fixible schema/ Oriented to web/ large-scale / open source/ document, XML or JSON
- Key-Value Stores, key-value pairs
- Graph Database, nodes connections

# Reference
- [Programming-Foundations-Databases](https://www.lynda.com/Software-Development-tutorials/Programming-Foundations-Databases/412845-2.html)